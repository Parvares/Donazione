function generateExcel(formData, books) {
  const documentText = `
DONAZIONE ALLA BIBLIOTECA ELSA MORANTE

Io sottoscritto ${formData.nome} ${formData.cognome}
Tessera n. ${formData.tessera || '_______________'}
Tel. ${formData.telefono || '_______________'}
e-mail ${formData.email}
dono alla Biblioteca le risorse documentarie allegate e autorizzo la biblioteca a destinarli all'uso che riterrà più opportuno (acquisizione al patrimonio, scambio, dono, bookcrossing o scarto, nel caso in cui, a giudizio insindacabile della biblioteca, i materiali risultino inutilizzabili) senza alcun vincolo per la biblioteca stessa nei miei confronti

Data: ${new Date().toLocaleDateString('it-IT')}`;

  const wb = XLSX.utils.book_new();
  const ws_data = [
    // Emphasize title with bold and centered alignment
    [{
      v: 'DONAZIONE ALLA BIBLIOTECA ELSA MORANTE',
      s: {
        font: { bold: true },
        alignment: { horizontal: 'center' }
      }
    }],
    // Separate donor information with blank lines
    [],
    [documentText.split('\n')[0]], // First line of donor information
    [],
    // Wrap remaining lines of donor information and align left
    ...documentText.split('\n').slice(1).map(line => ({
      v: line,
      s: { alignment: { horizontal: 'left', wrapText: true } }
    })),
    [],
    // Emphasize "Elenco dei libri donati:" with bold and centered alignment
    [{
      v: 'Elenco dei libri donati:',
      s: {
        font: { bold: true },
        alignment: { horizontal: 'center' }
      }
    }],
    [],
    // Adjust column widths for better readability
    ['Titolo', 'Autore', 'Editore', 'Anno', 'ISBN'].map(header => ({ v: header, wch: 30 })) // Adjust width based on content length
  ];

  books.forEach(book => {
    ws_data.push([book.title, book.author, book.publisher, book.year, book.isbn]);
  });

  const ws = XLSX.utils.aoa_to_sheet(ws_data);

  // Apply styles to header row (consider using a separate header object)
  const headerRow = ws['A1'];
  if (headerRow) {
    headerRow.s = {
      fill: { fgColor: { rgb: "FFFF00" } },
      font: { bold: true },
      alignment: { horizontal: 'center' }
    };
  }

  const mainContentStyle = { // Define reusable styling for donor info and book list
    alignment: { horizontal: 'left', wrapText: true }
  };

  // Apply styles to other header cells and donor information
  const styledCells = [
    'A8', 'B8', 'C8', 'D8', 'E8', // Header row
    ...documentText.split('\n').map((line, index) => `A${index + 4}`), // Donor information (excluding title)
  ];
  styledCells.forEach(cell => {
    if (ws[cell]) {
      ws[cell].s = mainContentStyle;
      // Consider additional styling for border, font color, etc. based on preference
    }
  });

  XLSX.utils.book_append_sheet(wb, ws, "Donazione");

  const wbout = XLSX.write(wb, { bookType: 'xlsx', type: 'binary' });
  const blob = new Blob([s2ab(wbout)], { type: 'application/octet-stream' });
  const url 1  = window.URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `donazione_${formData.cognome}_${formData.nome}.xlsx`;
  a.click();
  window.URL.revokeObjectURL(url);
}
